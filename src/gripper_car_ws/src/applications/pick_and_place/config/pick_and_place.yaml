# =============================================================================
# Pick and Place System Configuration
# =============================================================================
# Main configuration file for the pick-and-place state machine.
# =============================================================================

pick_and_place:
  # ---------------------------------------------------------------------------
  # Operation Mode
  # ---------------------------------------------------------------------------
  # continuous_mode: If true, robot loops continuously picking and delivering
  # If false, stops after one complete cycle
  continuous_mode: true

  # ---------------------------------------------------------------------------
  # Timeouts (seconds)
  # ---------------------------------------------------------------------------
  # Maximum time to wait for each operation before considering it failed
  timeouts:
    navigation: 120.0      # Time to navigate to a location
    arm_motion: 30.0       # Time for arm to complete a motion
    qr_scan: 10.0          # Time to scan and decode QR code
    gripper_action: 5.0    # Time for gripper open/close

  # ---------------------------------------------------------------------------
  # Retry Counts
  # ---------------------------------------------------------------------------
  # Number of times to retry failed operations before giving up
  retries:
    navigation: 3          # Navigation retries
    arm_motion: 2          # Arm motion retries
    pick_attempt: 2        # Pick sequence retries
    qr_scan: 3             # QR scan retries

  # ---------------------------------------------------------------------------
  # QR Scanner Settings
  # ---------------------------------------------------------------------------
  qr_scanner:
    camera_topic: "/camera/image_raw"   # Camera topic to subscribe to
    min_qr_size: 50                      # Minimum QR code size in pixels
    detection_timeout: 0.5               # Max time per detection attempt (s)

  # ---------------------------------------------------------------------------
  # Arm Configuration
  # ---------------------------------------------------------------------------
  arm:
    move_group_name: "arm"           # MoveIt planning group for arm
    gripper_group_name: "gripper"    # MoveIt planning group for gripper
    planning_time: 5.0               # Max planning time (seconds)
    velocity_scaling: 0.5            # Velocity scaling factor (0.0-1.0)
    acceleration_scaling: 0.5        # Acceleration scaling factor (0.0-1.0)

  # ---------------------------------------------------------------------------
  # Navigation Configuration
  # ---------------------------------------------------------------------------
  navigation:
    action_server: "/navigate_to_pose"   # Nav2 action server
    goal_frame: "map"                     # Frame for navigation goals
    robot_base_frame: "body_link"         # Robot base frame
    goal_tolerance_xy: 0.1                # Position tolerance (meters)
    goal_tolerance_yaw: 0.1               # Orientation tolerance (radians)

  # ---------------------------------------------------------------------------
  # State Machine Behavior
  # ---------------------------------------------------------------------------
  behavior:
    # If QR code is not recognized, use 'default' location from locations.yaml
    use_default_on_unknown_qr: true

    # If QR scan fails completely, return object to pickup location
    return_on_scan_failure: true

    # Delay between state transitions (seconds) for stability
    state_transition_delay: 0.5

    # Delay before starting gripper action after arm motion
    gripper_delay: 0.3
