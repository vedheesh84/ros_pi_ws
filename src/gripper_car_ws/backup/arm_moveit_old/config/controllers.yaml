#
# ROS2 CONTROLLERS CONFIGURATION - Mobile Manipulator Arm
# =========================================================
#
# DESCRIPTION:
#   Controller configuration for 6-DOF robotic arm
#   Used by ros2_control controller_manager
#
# CONTROLLERS:
#   - arm_controller: Joint trajectory controller for 5 arm joints
#   - gripper_controller: Gripper action controller
#   - joint_state_broadcaster: Publishes joint states
#
# USAGE:
#   Loaded by controller_manager on startup
#   Controllers can be activated/deactivated dynamically
#

controller_manager:
  ros__parameters:
    # Update rate for controller manager (Hz)
    update_rate: 100  # 100 Hz for smooth control

    # List of controllers
    arm_controller:
      type: joint_trajectory_controller/JointTrajectoryController

    gripper_controller:
      type: position_controllers/GripperActionController

    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster


# ============================================================================
# ARM CONTROLLER - Joint Trajectory Controller
# ============================================================================
arm_controller:
  ros__parameters:
    # Controlled joints (5 arm joints, excluding gripper)
    joints:
      - joint_1      # Base rotation
      - joint_2      # Shoulder
      - joint_3      # Elbow
      - joint_4      # Wrist
      - gripper_base_joint  # Gripper rotation

    # Command interfaces (what we send to hardware)
    command_interfaces:
      - position     # Position commands
      # - velocity   # Uncomment for velocity control

    # State interfaces (what we read from hardware)
    state_interfaces:
      - position     # Current position
      - velocity     # Current velocity

    # Action interface for MoveIt
    action_monitor_rate: 20.0  # Hz

    # Trajectory constraints
    constraints:
      stopped_velocity_tolerance: 0.01  # rad/s
      goal_time: 0.5                     # seconds

    # Per-joint tolerances
    joint_1:
      trajectory: 0.05      # rad
      goal: 0.02            # rad
    joint_2:
      trajectory: 0.05
      goal: 0.02
    joint_3:
      trajectory: 0.05
      goal: 0.02
    joint_4:
      trajectory: 0.05
      goal: 0.02
    gripper_base_joint:
      trajectory: 0.05
      goal: 0.02


# ============================================================================
# GRIPPER CONTROLLER - Gripper Action Controller
# ============================================================================
gripper_controller:
  ros__parameters:
    # Gripper joint
    joint: left_gear_joint  # Controls gripper open/close

    # Action interface
    action_monitor_rate: 20.0  # Hz

    # Gripper constraints
    goal_tolerance: 0.01       # rad
    max_effort: 5.0            # Nm (not enforced in simulation)
    allow_stalling: false
    stall_velocity_threshold: 0.001
    stall_timeout: 1.0


# ============================================================================
# JOINT STATE BROADCASTER
# ============================================================================
joint_state_broadcaster:
  ros__parameters:
    # No additional parameters needed
    # Automatically publishes /joint_states topic
    publish_rate: 50.0  # Hz
